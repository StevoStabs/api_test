<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title></title>
	</head>
	<body>
    	<h1 style="text-align: center;">Classes Report</h1>
		<pre id="yoyo"></pre>

		<script type="text/javascript">

			const sheetId = '1iFKOX_0BG46ZVEEPfBnytH8LsFdAsjbDro_BI1PibD4';
			const base = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?`;
			const sheetName = 'Classes-REPORT';
			const query = encodeURIComponent('Select *')
			const url = `${base}&sheet=${sheetName}&tq=${query}`
			
			const data = []
			document.addEventListener('DOMContentLoaded', init)
			
			function init() {
				fetch(url)
					.then(res => res.text())
					.then(rep => {
						//Remove additional text and extract only JSON:
						const jsonData = JSON.parse(rep.substring(47).slice(0, -2));
						// console.log(rep)
						document.getElementById('yoyo').innerHTML = JSON.stringify(jsonData, null, '\t');
						console.log("================+");
						console.log(jsonData);
						console.log("================+");
			
					})
			}

		</script>
	</body>
</html>
